{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { getBase644, beforeUpload4 } from \"../utils/index\";\nimport UseHome from \"../UseForm/UseHome\";\nimport axios from \"axios\";\n\nconst UsePostPublic = () => {\n  _s();\n\n  //States of Modal\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true); //States\n\n\n  const {\n    proveedor,\n    usuario,\n    setPublicacionActual,\n    publicacionActual\n  } = UseHome();\n  const [validation, setValidation] = useState(false);\n  const [flyer, setFlyer] = useState(\"\");\n  const token = localStorage.getItem(\"token\");\n  const [base64, setBase64] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [input, setInput] = useState({}); //Codigo de imagenes\n\n  const handlePic = async e => {\n    const pic = e.target.files[0];\n    const base64img = await getBase644(pic);\n    const changedInput = { ...input,\n      flyer: flyer\n    };\n    setInput(changedInput);\n    setBase64(base64img);\n    setFile(pic);\n  };\n\n  useEffect(() => {\n    const changedInput = { ...input,\n      flyer: flyer\n    };\n    setInput(changedInput);\n  }, [flyer]);\n\n  const handleUpload = () => {\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('upload_preset', 'wkuf5yo4');\n    fetch('https://api.cloudinary.com/v1_1/five-drive/upload', {\n      method: 'POST',\n      body: formData\n    }).then(res => res.json()).then(res => setFlyer(res.url));\n    handleClose();\n  }; //Funcions\n\n\n  const HandleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    const changedInput = { ...input,\n      [name]: value,\n      perfil: usuario.imagen,\n      proveedor: proveedor\n    };\n    setInput(changedInput);\n  };\n\n  const HandleSubmit = async e => {\n    e.preventDefault();\n\n    try {\n      console.log(input);\n      const headers = {\n        \"x-auth-token\": token\n      };\n      await axios.post(\"publicacion\", input, {\n        headers\n      });\n      setPublicacionActual(true);\n    } catch (error) {\n      console.log(error);\n      setValidation(true);\n    }\n  };\n\n  const onInputClick = event => {\n    event.target.value = \"\";\n  }; //Codigo para foto base 64\n\n  /*const onChangeImg = async (e) => {\n    const img = e.target.files[0];\n    const base64img = await getBase644(img);\n    const changedInput = { ...input, imagenPublicada: base64img };\n    setBase64(base64img);\n    setInput(changedInput);\n  };*/\n\n\n  return {\n    publicacionActual,\n    onInputClick,\n    HandleChange,\n    HandleSubmit,\n    handleUpload,\n    handleClose,\n    handleShow,\n    validation,\n    handlePic,\n    base64,\n    input,\n    show\n  };\n};\n\n_s(UsePostPublic, \"gzUH6Dpa/rr6BM11JnKGeBcxcP4=\");\n\n_c = UsePostPublic;\nexport default UsePostPublic;\n\nvar _c;\n\n$RefreshReg$(_c, \"UsePostPublic\");","map":{"version":3,"sources":["/home/conteo/Documentos/Full Stack/Andromeda/client/src/UseForm/UsePostPublic.js"],"names":["useState","useEffect","getBase644","beforeUpload4","UseHome","axios","UsePostPublic","show","setShow","handleClose","handleShow","proveedor","usuario","setPublicacionActual","publicacionActual","validation","setValidation","flyer","setFlyer","token","localStorage","getItem","base64","setBase64","file","setFile","input","setInput","handlePic","e","pic","target","files","base64img","changedInput","handleUpload","formData","FormData","append","fetch","method","body","then","res","json","url","HandleChange","name","value","perfil","imagen","HandleSubmit","preventDefault","console","log","headers","post","error","onInputClick","event"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { getBase644, beforeUpload4 } from \"../utils/index\";\nimport UseHome from \"../UseForm/UseHome\";\nimport axios from \"axios\";\n\nconst UsePostPublic = () => {\n  //States of Modal\n    const [show, setShow] = useState(false);\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n  //States\n    const { proveedor, usuario, setPublicacionActual, publicacionActual } = UseHome();\n    const [validation, setValidation] = useState(false);\n    const [ flyer, setFlyer] = useState(\"\")\n    const token = localStorage.getItem(\"token\");\n    const [base64, setBase64] = useState(\"\");\n    const [ file, setFile ] = useState(null)\n    const [input, setInput] = useState({});\n\n  //Codigo de imagenes\n  const handlePic = async (e) => {\n    const pic = e.target.files[0];\n    const base64img = await getBase644(pic);\n    const changedInput = { ...input, flyer: flyer };\n    setInput(changedInput);\n    setBase64(base64img);\n    setFile(pic)\n  }\n \n  useEffect(() => {\n    const changedInput = { ...input, flyer: flyer };\n    setInput(changedInput);\n  },[flyer])\n\n  const handleUpload = () => {\n    const formData = new FormData()\n    formData.append('file', file)\n    formData.append('upload_preset', 'wkuf5yo4')\n    fetch('https://api.cloudinary.com/v1_1/five-drive/upload', {\n      method: 'POST',\n      body: formData,\n    })\n    .then(res => res.json())\n    .then(res => setFlyer(res.url))\n    handleClose()\n  }\n\n  //Funcions\n  const HandleChange = (e) => {\n    const { name, value } = e.target;\n    const changedInput = {\n      ...input,\n      [name]: value,\n      perfil: usuario.imagen,\n      proveedor: proveedor,\n    };\n    setInput(changedInput);\n  };\n\n\n  const HandleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      console.log(input)\n      const headers = { \"x-auth-token\": token };\n      await axios.post(\"publicacion\", input, { headers });\n      setPublicacionActual(true);\n    } catch (error) {\n      console.log(error);\n      setValidation(true);\n    }\n  };\n\n  const onInputClick = (event) => {\n    event.target.value = \"\";\n  };\n\n  //Codigo para foto base 64\n  /*const onChangeImg = async (e) => {\n    const img = e.target.files[0];\n    const base64img = await getBase644(img);\n    const changedInput = { ...input, imagenPublicada: base64img };\n    setBase64(base64img);\n    setInput(changedInput);\n  };*/\n\n  return {\n    publicacionActual,\n    onInputClick,\n    HandleChange,\n    HandleSubmit,\n    handleUpload,\n    handleClose,\n    handleShow,\n    validation,\n    handlePic,\n    base64,\n    input,\n    show,\n  };\n};\nexport default UsePostPublic;\n"]},"metadata":{},"sourceType":"module"}